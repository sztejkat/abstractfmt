<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>sztejkat.abstractfmt.txt.plain</title>
      
  <meta http-equiv="content-type"
 content="text/html; charset=UTF-8">
</head>
<body>
      An oversimplified text format laid directly on
      <code>sztejkat.abstractfmt.txt</code> engines.
      <p>
      The main purpose of this format is to provide a test bed 
      for text format engines, but it can be used for regular,
      production purposes.

      <h1>Format description</h1>
      A text format using UTF-8 encoding.
      All characters are allowed, BOM on the beginning of stream is not allowed.
      
      <h2>Notation</h2>
      A reg-ex like BNF:
      <pre>
           begin_signal:= empty_char* &lt;
           noob:= empty_char+ *
           boop:= empty_char? x
           escaped_char:= x | y
           data:-  ^( x | y ) 
      </pre>
      means:
      <br><i>"The 'begin_signal' is encoded as any number of 'empty_char' followed by &lt;"</i>
      <br><i>"The 'noob' is encoded as at least one 'empty_char' followed by *"</i>
      <br><i>"The 'boop' is encoded as one or zero 'empty_char' followed by x"</i>
      <br><i>"The 'escaped_char' is either x or y"</i>
      <br><i>"The 'data' is anything except x or y"</i>

      <h2>Signal</h2>
      This format does not support neither names registry nor end-begin optimization.
      <h3>Begin signal</h3>
      Begin signal is encoded as
      <pre>
           begin_signal:=  * signal_name
           					|
           				  <i>start of file</i> * signal_name
           signal_name:=   string_token_body
           					|
           				   plain_token_body
           empty_char:= any Java whitespace, including end-of-lines.
      </pre>
      The <code>string_token_body</code> form of signal name is chosen
      when signal name does not fit the definition of <code>plain_token_body</code>. 

      <h3>End signal</h3>
      Begin signal is encoded as
      <pre>
            end_signal:= empty_char* ;
      </pre>


      <h2>Tokens</h2>
      <h3>Plain token</h3>
      Plain token is encoded as:
      <pre>
           plain_token:=  plain_token_body
           plain_token_body:= (^( empty_char |  token_separator | " | * | ; ))*           
      </pre>
      

      <h3>String token</h3>
      String token is encoded as:
      <pre>
           string_token:= string_token_body
           string_token_body:= " escaped_char* "
           escaped_char:= ^" | ""
      </pre>
      <i>Inside a string token we escape the " by doubling it "". Anything else is allowed
      and stored without any escaping, including end of lines.</i>.
      
      <h3>Entire file</h3>
      <pre>
        file:= body? (struct body?)*
        body:= empty_char* ((plain_token | string_token) ( empty_char * token_separator empty_char * (plain_token | string_token))*)?
        struct:= empty_char* begin_signal 
        			(
        				( body? empty_char* )
        				|
        				( body? struct? body? )
        			) empty_char* end_signal
      </pre>
      
      <h2>Numbers and etc.</h2>
      Compatible with <code>sztejkat.abstractfmt.txt.ATxtReadFormat0</code>,
      produced by <code>sztejkat.abstractfmt.txt.ATxtWriterFormat0</code>.
      <p>
      Notice we are using . as decimal separator.

      <h1>Example</h1>
      <h2>Simple example</h2>
      A stream produced by <code>IStructWriteFormat</code> calls:
      <pre>
      	begin("int")
      	writeInt(34458)
      	end()
      </pre>
      looks like: 
      <pre>
      *int 34458;
      </pre>
      However following are also correct:
      <pre>
      *int
         34458
      ;
      </pre>
      and below also represents the same content:
      <pre>
      *"int" "34458" ;
      </pre>
      
      <h2>Complex example</h2>
      A stream produced by <code>IStructWriteFormat</code> calls:
      <pre>
      	begin("Joanna d'Arc")
      	writeDouble(1.58)
      	writeDouble(45.4)
      		begin("city")
      			writeString("bolongque")
      			writeString(" western")
      		end()
      	end()
      </pre>
      looks like: 
      <pre>
      *"Joanna d'Arc" 1.58, 45.4 *city "bolongque"," western";; 
      </pre>
      Notice, we do not stich separate string block writes to one string in a file,
      however during read it <u>is</u> stitched to one continous block.
</body>
</html>
